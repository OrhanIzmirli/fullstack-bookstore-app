<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Our Book Garden â€“ The Blossom Bookstore</title>
  <link rel="stylesheet" href="shop.css" />
  <script src="https://js.stripe.com/v3/"></script>
  <script src="shop.js" defer></script>
</head>

<body>
  <!-- Site Header -->
  <header class="site-header">
    <img src="images/logo.png" alt="Blossom Logo Light" class="header-logo logo-light" />
    <img src="images/logo_dark.png" alt="Blossom Logo Dark" class="header-logo logo-dark" />
    <h1 class="site-title">The Blossom Bookstore</h1>

    <div class="header-controls">
      <button id="profileBtn" class="profile-btn" title="Edit profile">Guest</button>

      <button id="wishlistBtn" class="wishlist-btn" aria-label="Open wishlist">
        ğŸ¤ <span id="wishlistCount">0</span>
      </button>

      <button id="cartBtn" class="cart-btn" aria-label="Open cart">
        ğŸ›’ <span id="cartCount">0</span>
      </button>

      <button class="darkmode-toggle" title="Toggle theme" aria-pressed="false">ğŸŒ“</button>

      <button id="logoutBtn" class="logout-btn" title="Logout">ğŸšª</button>

      <a href="orders.html" class="btn" style="margin-left: 10px;">ğŸ“œ My Orders</a>

      <!-- âœ… Admin link (only visible if role === admin) -->
      <div id="adminLinkWrapper" style="display: none;">
        <a href="/admin" class="admin-btn">ğŸ‘‘ Admin Panel</a>
      </div>
    </div>
  </header>

  <main class="shop-wrapper">
    <h2>Our Book Garden</h2>

    <div class="controls">
      <input id="searchInput" type="text" placeholder="Search by title or authorâ€¦" />
      <select id="sortSelect">
        <option value="default">Sort byâ€¦</option>
        <option value="title-asc">Title A â†’ Z</option>
        <option value="title-desc">Title Z â†’ A</option>
        <option value="price-asc">Price Low â†’ High</option>
        <option value="price-desc">Price High â†’ Low</option>
      </select>
    </div>

    <div id="productGrid" class="product-grid"></div>
    <div id="loader" class="loader">Loading more booksâ€¦</div>
  </main>

  <aside id="cartSidebar" class="cart-sidebar">
    <button id="closeCart" class="close-cart" aria-label="Close cart">âœ•</button>
    <h3>Your Cart</h3>
    <ul id="cartItems" class="cart-items"></ul>

    <div class="cart-total">
      <span>Total:</span> <strong id="cartTotal">$0.00</strong>
    </div>

    <button id="checkoutBtn" class="checkout-btn">Checkout</button>
  </aside>

  <aside id="wishlistSidebar" class="wishlist-sidebar">
    <button id="closeWishlist" class="close-cart" aria-label="Close wishlist">âœ•</button>
    <h3>Your Wishlist</h3>
    <ul id="wishlistItems" class="cart-items"></ul>
    <button id="clearWishlist" class="checkout-btn">Clear Wishlist</button>
  </aside>

  <!-- Profile Modal -->
  <div id="profileOverlay" class="modal-overlay">
    <div class="modal profile-modal">
      <button id="closeProfile" class="modal-close" aria-label="Close profile">âœ•</button>
      <h3>Your Profile</h3>

      <form id="profileForm">
        <label>First Name <input id="firstName" type="text" placeholder="First Name" required></label>
        <label>Last Name <input id="lastName" type="text" placeholder="Last Name" required></label>
        <label>Email <input id="profileEmail" type="email" placeholder="you@example.com" required></label>
        <label>Phone <input id="profilePhone" type="tel" placeholder="+1 555-555-5555"></label>
        <button type="submit" class="checkout-btn">Save Profile</button>
      </form>
    </div>
  </div>

  <!-- Book Detail Modal -->
  <div id="modalOverlay" class="modal-overlay">
    <div class="modal">
      <button id="closeModal" class="modal-close" aria-label="Close info">âœ•</button>
      <h3 id="modalTitle"></h3>
      <p id="modalDesc"></p>
      <p><strong>Subjects:</strong> <span id="modalSubjects"></span></p>
      <p><strong>First published:</strong> <span id="modalDate"></span></p>

      <hr />

      <div class="review-form">
        <h4>Leave a Review</h4>

        <div class="star-input">
          <label data-value="1">â˜†<input type="radio" name="rating" value="1"></label>
          <label data-value="2">â˜†<input type="radio" name="rating" value="2"></label>
          <label data-value="3">â˜†<input type="radio" name="rating" value="3"></label>
          <label data-value="4">â˜†<input type="radio" name="rating" value="4"></label>
          <label data-value="5">â˜†<input type="radio" name="rating" value="5"></label>
        </div>

        <textarea id="reviewText" rows="3" placeholder="Your commentâ€¦"></textarea>
        <button id="submitReview" class="submit-review-btn">Submit Review</button>
      </div>

      <hr />

      <div class="reviews-list">
        <h4>Reviews</h4>
        <ul id="reviewsContainer"></ul>
      </div>
    </div>
  </div>

  <!-- Payment Modal -->
  <div id="paymentOverlay" class="modal-overlay hidden">
    <div class="modal">
      <button id="closePayment" class="modal-close" aria-label="Close payment">âœ•</button>
      <h3>Payment Details</h3>

      <form id="paymentForm">
        <label>Card Number <input type="text" id="cardNumber" required placeholder="1234 5678 9012 3456" /></label>
        <label>Expiry Date <input type="text" id="expiry" required placeholder="MM/YY" /></label>
        <label>CVV <input type="text" id="cvv" required placeholder="123" /></label>
        <button type="submit" class="checkout-btn">Pay Now</button>
      </form>
    </div>
  </div>

  <!-- âœ… Show admin link only when role is admin -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const adminWrapper = document.getElementById("adminLinkWrapper");
      if (!adminWrapper) return;

      adminWrapper.style.display = (localStorage.getItem("role") === "admin")
        ? "inline-block"
        : "none";
    });
  </script>
</body>
</html>
